<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<link rel="STYLESHEET" href="ceODBC.css" type='text/css' />
<link rel="first" href="ceODBC.html" title='ceODBC' />
<link rel='contents' href='contents.html' title="Contents" />
<link rel='last' href='about.html' title='About this document...' />
<link rel='help' href='about.html' title='About this document...' />
<link rel="next" href="varobj.html" />
<link rel="prev" href="connobj.html" />
<link rel="parent" href="ceODBC.html" />
<link rel="next" href="varobj.html" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name='aesop' content='information' />
<title>3. Cursor Objects</title>
</head>
<body>
<div class="navigation">
<div id='top-navigation-panel' xml:id='top-navigation-panel'>
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class='online-navigation'><a rel="prev" title="2. connection Objects"
  href="connobj.html"><img src='previous.png'
  border='0' height='32'  alt='Previous Page' width='32' /></a></td>
<td class='online-navigation'><a rel="parent" title="ceODBC"
  href="ceODBC.html"><img src='up.png'
  border='0' height='32'  alt='Up one Level' width='32' /></a></td>
<td class='online-navigation'><a rel="next" title="4. variable Objects"
  href="varobj.html"><img src='next.png'
  border='0' height='32'  alt='Next Page' width='32' /></a></td>
<td align="center" width="100%">ceODBC</td>
<td class='online-navigation'><a rel="contents" title="Table of Contents"
  href="contents.html"><img src='contents.png'
  border='0' height='32'  alt='Contents' width='32' /></a></td>
<td class='online-navigation'><img src='blank.png'
  border='0' height='32'  alt='' width='32' /></td>
<td class='online-navigation'><img src='blank.png'
  border='0' height='32'  alt='' width='32' /></td>
</tr></table>
<div class='online-navigation'>
<b class="navlabel">Previous:</b>
<a class="sectref" rel="prev" href="connobj.html">2. Connection Objects</a>
<b class="navlabel">Up:</b>
<a class="sectref" rel="parent" href="ceODBC.html">ceODBC</a>
<b class="navlabel">Next:</b>
<a class="sectref" rel="next" href="varobj.html">4. Variable Objects</a>
</div>
<hr /></div>
</div>
<!--End of Navigation Panel-->

<h1><a name="SECTION005000000000000000000"></a><a name="cursorobj"></a>
<br>
3. Cursor Objects
</h1>

<p>
<dl><dt><b><tt id='l2h-57' xml:id='l2h-57'>arraysize</tt></b></dt>
<dd>
  This read-write attribute specifies the number of rows to fetch at a time
  internally and is the default number of rows to fetch with the fetchmany()
  call. It defaults to 1 meaning to fetch a single row at a time. Note that
  this attribute can drastically affect the performance of a query since it
  directly affects the number of network round trips that need to be performed.
</dd></dl>

<p>
<dl><dt><b><tt id='l2h-58' xml:id='l2h-58'>bindarraysize</tt></b></dt>
<dd>
  This read-write attribute specifies the number of rows to bind at a time and
  is used when creating variables via setinputsizes(). It defaults to 1 meaning
  to bind a single row at a time.

<p>
<strong>NOTE:</strong> The DB API definition does not define this attribute.
</dd></dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-59' xml:id='l2h-59' class="function">callfunc</tt></b>(</nobr></td>
  <td><var><var>name</var>, <var>returnType</var>, <var>*args</var></var>)</td></tr></table></dt>
<dd>
  Call a function with the given name. Parameters may also be passed as a
  single list or tuple to conform to the DB API. The return type is specified
  in the same notation as is required by setinputsizes(). The result of the
  call is the return value of the function.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-60' xml:id='l2h-60' class="function">callproc</tt></b>(</nobr></td>
  <td><var><var>name</var>, <var>*args</var></var>)</td></tr></table></dt>
<dd>
  Call a procedure with the given name. Parameters may also be passed as a
  single list or tuple to conform to the DB API. The result of the call is a
  modified copy of the input sequence. Input parameters are left untouched;
  output and input/output parameters are replaced with possibly new values.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-61' xml:id='l2h-61' class="function">close</tt></b>(</nobr></td>
  <td><var></var>)</td></tr></table></dt>
<dd>
  Close the cursor now, rather than whenever __del__ is called. The cursor will
  be unusable from this point forward; an Error exception will be raised if any
  operation is attempted with the cursor.
</dl>

<p>
<dl><dt><b><tt id='l2h-62' xml:id='l2h-62'>connection</tt></b></dt>
<dd>
  This read-only attribute returns a reference to the connection object on
  which the cursor was created.

<p>
<strong>NOTE:</strong> This attribute is an extension to the DB API definition but it
  is mentioned in PEP 249 as an optional extension.
</dd></dl>

<p>
<dl><dt><b><tt id='l2h-63' xml:id='l2h-63'>description</tt></b></dt>
<dd>
  This read-only attribute is a sequence of 7-item sequences. Each of these
  sequences contains information describing one result column: (name, type,
  display_size, internal_size, precision, scale, null_ok). This attribute will
  be None for operations that do not return rows or if the cursor has not had
  an operation invoked via the execute() method yet.

<p>
The type will be one of the variable type objects (<a href="vartypes.html#vartypes">1.3</a>) and is
  comparable to the type objects defined by the DB API.
</dd></dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-64' xml:id='l2h-64' class="function">execute</tt></b>(</nobr></td>
  <td><var><var>statement</var>, <var>*args</var></var>)</td></tr></table></dt>
<dd>
  Execute a statement against the database. Paramters may also be passed as a
  single list or tuple to conform to the DB API.

<p>
A reference to the statement will be retained by the cursor. If None or the
  same string object is passed in again, the cursor will execute that
  statement again without performing a prepare or rebinding and redefining.
  This is most effective for algorithms where the same statement is used, but
  different parameters are bound to it (many times).

<p>
For maximum efficiency when reusing an statement, it is best to use the
  setinputsizes() method to specify the parameter types and sizes ahead of
  time; in particular, None is assumed to be a string of length 1 so any
  values that are later bound as numbers or dates will raise a TypeError
  exception.

<p>
If the statement is a query, the cursor is returned as a convenience since
  cursors implement the iterator protocol and there is thus no need to call
  one of the appropriate fetch methods; otherwise None is returned.

<p>
<strong>NOTE:</strong> The DB API definition does not define the return value of this
  method.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-65' xml:id='l2h-65' class="function">executemany</tt></b>(</nobr></td>
  <td><var><var>statement</var>, <var>parameters</var></var>)</td></tr></table></dt>
<dd>
  Prepare a statement for execution against a database and then execute it
  against all parameter sequences found in the sequence parameters. The
  statement is managed in the same way as the execute() method manages it.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-66' xml:id='l2h-66' class="function">fetchall</tt></b>(</nobr></td>
  <td><var></var>)</td></tr></table></dt>
<dd>
  Fetch all (remaining) rows of a query result, returning them as a list of
  tuples. An empty list is returned if no more rows are available. Note that
  the cursor's arraysize attribute can affect the performance of this
  operation, as internally reads from the database are done in batches
  corresponding to the arraysize.

<p>
An exception is raised if the previous call to execute() did not produce any
  result set or no call was issued yet.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-67' xml:id='l2h-67' class="function">fetchmany</tt></b>(</nobr></td>
  <td><var><var>numRows=cursor.arraysize</var></var>)</td></tr></table></dt>
<dd>
  Fetch the next set of rows of a query result, returning a list of tuples. An
  empty list is returned if no more rows are available. Note that the cursor's
  arraysize attribute can affect the performance of this operation.

<p>
The number of rows to fetch is specified by the parameter. If it is not
  given, the cursor's arrysize attribute determines the number of rows to be
  fetched. If the number of rows available to be fetched is fewer than the
  amount requested, fewer rows will be returned.

<p>
An exception is raised if the previous call to execute() did not produce any
  result set or no call was issued yet.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-68' xml:id='l2h-68' class="function">fetchone</tt></b>(</nobr></td>
  <td><var></var>)</td></tr></table></dt>
<dd>
  Fetch the next row of a query result set, returning a single tuple or None
  when no more data is available.

<p>
An exception is raised if the previous call to execute() did not produce any
  result set or no call was issued yet.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-69' xml:id='l2h-69' class="function">__iter__</tt></b>(</nobr></td>
  <td><var></var>)</td></tr></table></dt>
<dd>
  Returns the cursor itself to be used as an iterator.

<p>
<strong>NOTE:</strong> This method is an extension to the DB API definition but it
  is mentioned in PEP 249 as an optional extension.
</dl>

<p>
<dl><dt><b><tt id='l2h-70' xml:id='l2h-70'>name</tt></b></dt>
<dd>
  This read-write attribute returns the name associated with the cursor. This
  name is used in positioned update or delete statements (as in delete from X
  where current of &lt;NAME&gt;).

<p>
<strong>NOTE:</strong> This attribute is an extension to the DB API definition.
</dd></dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-71' xml:id='l2h-71' class="function">next</tt></b>(</nobr></td>
  <td><var></var>)</td></tr></table></dt>
<dd>
  Fetch the next row of a query result set, using the same semantics as
  the method fetchone().

<p>
<strong>NOTE:</strong> This method is an extension to the DB API definition but it
  is mentioned in PEP 249 as an optional extension.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-72' xml:id='l2h-72' class="function">prepare</tt></b>(</nobr></td>
  <td><var><var>statement</var></var>)</td></tr></table></dt>
<dd>
  This can be used before a call to execute() to define the statement that will
  be executed. When this is done, the prepare phase will not be performed when
  the call to execute() is made with None or the same string object as the
  statement.

<p>
<strong>NOTE:</strong> The DB API definition does not define this method.
</dl>

<p>
<dl><dt><b><tt id='l2h-73' xml:id='l2h-73'>rowcount</tt></b></dt>
<dd>
  This read-only attribute specifies the number of rows that have currently
  been fetched from the cursor (for select statements) or that have been
  affected by the operation (for insert, update and delete statements).
</dd></dl>

<p>
<dl><dt><b><tt id='l2h-74' xml:id='l2h-74'>rowfactory</tt></b></dt>
<dd>
  This read-write attribute specifies a method to call for each row that is
  retrieved from the database. Ordinarily a tuple is returned for each row but
  if this attribute is set, the method is called with the argument tuple that
  would normally be returned and the result of the method is returned instead.

<p>
<strong>NOTE:</strong> The DB API definition does not define this attribute.
</dd></dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-75' xml:id='l2h-75' class="function">setinputsizes</tt></b>(</nobr></td>
  <td><var><var>*args</var></var>)</td></tr></table></dt>
<dd>
  This can be used before a call to execute() to predefine memory areas for the
  operation's parameters. Each parameter should be a type object corresponding
  to the input that will be used or it should be an integer specifying the
  maximum length of a string parameter. The singleton None can be used as a
  parameter to indicate that no space should be reserved for that position.
  Note that in order to conform to the DB API, passing a single argument which
  is a list or tuple will treat that list or tuple as the arguments sequence.
</dl>

<p>
<dl><dt><table cellpadding="0" cellspacing="0"><tr valign="baseline">
  <td><nobr><b><tt id='l2h-76' xml:id='l2h-76' class="function">setoutputsize</tt></b>(</nobr></td>
  <td><var><var>size</var>, </var><big>[</big><var><var>column</var></var><big>]</big><var></var>)</td></tr></table></dt>
<dd>
  This can be used before a call to execute() to predefine memory areas for the
  long columns that will be fetched. The column is specified as an index into
  the result sequence. Not specifying the column will set the default size for
  all large columns in the cursor.
</dl>

<p>
<dl><dt><b><tt id='l2h-77' xml:id='l2h-77'>statement</tt></b></dt>
<dd>
  This read-only attribute provides the string object that was previously
  prepared with prepare() or executed with execute().

<p>
<strong>NOTE:</strong> The DB API definition does not define this attribute.
</dd></dl>

<p>

<div class="navigation">
<div class='online-navigation'>
<p></p><hr />
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td class='online-navigation'><a rel="prev" title="2. connection Objects"
  href="connobj.html"><img src='previous.png'
  border='0' height='32'  alt='Previous Page' width='32' /></a></td>
<td class='online-navigation'><a rel="parent" title="ceODBC"
  href="ceODBC.html"><img src='up.png'
  border='0' height='32'  alt='Up one Level' width='32' /></a></td>
<td class='online-navigation'><a rel="next" title="4. variable Objects"
  href="varobj.html"><img src='next.png'
  border='0' height='32'  alt='Next Page' width='32' /></a></td>
<td align="center" width="100%">ceODBC</td>
<td class='online-navigation'><a rel="contents" title="Table of Contents"
  href="contents.html"><img src='contents.png'
  border='0' height='32'  alt='Contents' width='32' /></a></td>
<td class='online-navigation'><img src='blank.png'
  border='0' height='32'  alt='' width='32' /></td>
<td class='online-navigation'><img src='blank.png'
  border='0' height='32'  alt='' width='32' /></td>
</tr></table>
<div class='online-navigation'>
<b class="navlabel">Previous:</b>
<a class="sectref" rel="prev" href="connobj.html">2. Connection Objects</a>
<b class="navlabel">Up:</b>
<a class="sectref" rel="parent" href="ceODBC.html">ceODBC</a>
<b class="navlabel">Next:</b>
<a class="sectref" rel="next" href="varobj.html">4. Variable Objects</a>
</div>
</div>
<hr />
<span class="release-info">Release HEAD, documentation updated on October 26, 2007.</span>
</div>
<!--End of Navigation Panel-->

</body>
</html>
